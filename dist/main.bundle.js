/*! For license information please see main.bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Flxy=t():e.Flxy=t()}("undefined"!=typeof self?self:this,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.d(t,{default:()=>xt});var n={};e.r(n),e.d(n,{emit:()=>d,off:()=>h,on:()=>p,once:()=>g,subscribe:()=>y,unsubscribe:()=>w});var r={};e.r(r),e.d(r,{action:()=>M,actions:()=>O,clear:()=>C,dispatch:()=>I,get:()=>L,init:()=>T,notify:()=>$,persist:()=>A,set:()=>x,subscribe:()=>j});var o={};e.r(o),e.d(o,{clearListeners:()=>Y,error:()=>_,executeHandler:()=>Q,executeMiddlewares:()=>H,getCurrentQuery:()=>Z,getHistory:()=>X,getParsedQuery:()=>z,handle:()=>F,init:()=>R,matchDynamicRoute:()=>B,navigate:()=>J,notifyListeners:()=>W,onChange:()=>V,refresh:()=>K,register:()=>q,setState:()=>G});var a={};e.r(a),e.d(a,{addMiddleware:()=>re,configure:()=>ne,deleteRequest:()=>ue,executeMiddlewares:()=>oe,get:()=>ie,getNamedMiddlewares:()=>ae,post:()=>se,put:()=>ce,request:()=>le});var i={};e.r(i),e.d(i,{default:()=>De,getByKey:()=>Me,init:()=>Ue,load:()=>Ie,replacePlaceholders:()=>Oe,setPrefix:()=>$e,translate:()=>Ne});var s={};e.r(s),e.d(s,{addToCache:()=>Qe,cache:()=>Ke,deleteFromCache:()=>Je,engine:()=>_e,get:()=>He,getHTML:()=>We,parseTemplate:()=>Be,preload:()=>Ge,refreshCache:()=>Ve,render:()=>ze,setConfig:()=>Ze,setContainer:()=>Xe,setPrefix:()=>Fe});var c={};e.r(c),e.d(c,{checkPermission:()=>it,generateFingerprint:()=>ct,generateId:()=>tt,getBrowserInfo:()=>rt,getCapabilities:()=>ot,getDeviceType:()=>lt,getId:()=>nt,getNetworkInfo:()=>at,getStorageInfo:()=>st,hashString:()=>ut,init:()=>et});var u={};e.r(u),e.d(u,{addListener:()=>ht,init:()=>pt,removeListener:()=>gt});var l={};e.r(l),e.d(l,{STATES:()=>mt,checkLocationPermission:()=>St,default:()=>vt,get:()=>bt,getLatLongFromNavigator:()=>kt,getLocationPermissionState:()=>Et,promptForLocationPermission:()=>Pt});const f={events:{}};function d(e,...t){f.events[e]&&f.events[e].forEach((e=>e(...t)))}function p(e,t){f.events[e]||(f.events[e]=[]),f.events[e].push(t)}function h(e,t){f.events[e]&&(f.events[e]=f.events[e].filter((e=>e!==t)))}function g(e,t){const n=(...r)=>{t(...r),h(e,n)};p(e,n)}function y(e,t){(e=Array.isArray(e)?e:[e]).forEach((e=>p(e,t)))}function w(e,t){(e=Array.isArray(e)?e:[e]).forEach((e=>h(e,t)))}const m={prefix:"",key(e){return this.prefix+e},cookie:{get(e){const t=m.key(e),n=("; "+document.cookie).split("; "+t+"=");if(2===n.length)return n.pop().split(";").shift()},set(e,t,n){const r=m.key(e);let o="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),o="; expires="+e.toUTCString()}document.cookie=r+"="+t+o+"; path=/"},delete(e){const t=m.key(e);document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"}},local:{get(e){const t=m.key(e),n=localStorage.getItem(t);if(!n)return;const r=JSON.parse(n),{value:o,timestamp:a}=r;if(!(a&&Date.now()>a))return o;localStorage.removeItem(t)},set(e,t,n){const r=m.key(e),o=n?Date.now()+24*n*60*60*1e3:null,a=JSON.stringify({value:t,timestamp:o});localStorage.setItem(r,a)},delete(e){const t=m.key(e);localStorage.removeItem(t)}},session:{get(e){const t=m.key(e),n=sessionStorage.getItem(t);if(!n)return;const r=JSON.parse(n),{value:o,timestamp:a}=r;if(!(a&&Date.now()>a))return o;sessionStorage.removeItem(t)},set(e,t,n){const r=m.key(e),o=n?Date.now()+24*n*60*60*1e3:null,a=JSON.stringify({value:t,timestamp:o});sessionStorage.setItem(r,a)},delete(e){const t=m.key(e);sessionStorage.removeItem(t)}}},v=m,{cookie:b,local:E,session:S}=v,k="appState",P={state:{},subscribers:{},actions:{},action:{}};function T(e={}){const t={...E.get(k)||{},...e};Object.keys(t).forEach((e=>x(e,t[e],!1)))}function L(e){return P.state[e]}function x(e,t,n=!0){P.state[e]=t,n&&P.notify(e)}function A(){E.set(k,P.state)}function C(){E.delete(k),P.state={},P.subscribers={},console.log("State has been cleared and localStorage removed.")}function j(e,t){(e=Array.isArray(e)?e:[e]).forEach((e=>{P.subscribers[e]||(P.subscribers[e]=[]),P.subscribers[e].push(t)}))}function $(e){P.subscribers[e]&&P.subscribers[e].forEach((t=>t(e,P.state[e])))}function I(e,t){P.actions[e]?P.actions[e](t):console.error(`Action ${e} not found`)}P.action.register=function(e,t){"function"==typeof t?"string"==typeof e?P.actions[e]=t:console.error("The action name must be of type string."):console.error("The action function must be of type function.")};const M=P.action;P.actions.fetch=async function({key:e,url:t}){try{const n=await fetch(t);x(e,await n.json())}catch(e){console.error("Error fetching data:",e)}},P.actions.update=function(e,t){x(e,t)};const O=P.actions,N={FETCHING:"fetching",NULL:null,LOADING:"loading",SUCCESS:"success",FAILED:"failed"},U={handle(e,t){console.error(`Error ${e}: ${t}`)}},D={currentPath:null,currentQuery:new URLSearchParams(window.location.search),listeners:[],history:[],routes:{},routeStates:{},middlewares:[]},R=()=>{ee(),window.addEventListener("popstate",(()=>{D.currentQuery=new URLSearchParams(window.location.search),F()}))},q=(e,t,n=[])=>{if(n="function"==typeof n?[n]:n,!Array.isArray(n)||n.some((e=>"function"!=typeof e)))throw new Error(`Middleware should be a function or an array of functions for route ${e}`);if("function"!=typeof t)throw new Error(`Handler should be a function for route ${e}`);const r=/:[^/]+/g.test(e);D.routes[e]={handler:t,middlewares:n,isDynamic:r}},F=async(e=()=>{})=>{const t=z();if(e="function"!=typeof e?()=>{}:e,!t.routeName)return D.navigating=!1,e({status:404}),void console.log("No route");const n=t.routeName,r=D.routes[n]||D.routes["/404"],{handler:o,middlewares:a}=r||{};if(D.currentPath=n,!o)return e({status:404}),void _(404);G(n,N.LOADING);const i={path:D.currentPath,query:Z(),params:t.params};try{if(!(await H(a,i)).every((e=>e)))return _(400);await Q(o,i),G(n,N.SUCCESS)}catch(e){console.error("Error:",e),e(500)}W(i),D.navigating=!1,e({status:200})},_=e=>{U.handle(e,`Route handling failed for ${D.currentPath}`),D.navigating=!1},H=async(e,t)=>{const n=await Promise.all(e.map((async e=>{try{return await e(t)}catch(t){return console.error(String(e.name),t),!1}})));return n},G=(e,t)=>{D.routeStates[e]=t,console.log(`Route ${e} is in state: ${t}`)},Q=async(e,t)=>{console.log("Loading...",t),await e(t)},J=(e,t={},n=!1)=>{if(D.navigating)return console.log("Busy");const r=new URL(e,window.location.origin),o=r.pathname,a={...Object.fromEntries(r.searchParams.entries()),...t};console.log("mergedQuery",a,e,o),a.route=o;const i=new URLSearchParams(a).toString(),s=`${window.location.pathname}?${i}`;if(n)return window.open(s,"_blank");D.currentQuery.toString()!==i&&(D.navigating=!0,D.currentQuery=new URLSearchParams(a),window.history.pushState({},"",s),D.history.push({query:a}),F())},V=e=>{"function"==typeof e&&D.listeners.push(e)},W=e=>{D.listeners.forEach((t=>t(e)))},z=()=>{const e=D.currentQuery.get("route"),t=D.routes[e],n=t||B(e);return{routeName:t?e:n?n.routeName:null,queryRoute:e,params:n?.params||{}}},B=e=>{for(const[t,n]of Object.entries(D.routes))if(n.isDynamic&&e){const r=new RegExp(`^${t.replace(/:[^/]+/g,"([^/]+)")}$`),o=e.match(r);if(o){const e={};return t.match(/:([^/]+)/g).map((e=>e.substring(1))).forEach(((t,n)=>{e[t]=o[n+1]})),{...n,params:e,routeName:t}}}return null},K=(e=Z())=>{e.route&&console.warn("Please use navigate to move to a new route"),e.route=D.currentPath,J(D.currentPath,e)},Z=()=>Object.fromEntries(D.currentQuery),X=()=>[...D.history],Y=()=>{D.listeners=[]},ee=()=>{document.addEventListener("click",(e=>{const t=e.target.closest("a");if(!t||!t.hasAttribute("href"))return;const n=t.getAttribute("href");if(!n.startsWith("/"))return;if(1===e.button)return;let r=e.ctrlKey||e.metaKey||e.shiftKey;e.preventDefault(),t._navigating||(t._navigating=!0,setTimeout((()=>t._navigating=!1),100),J(n,{},r))}))},te={baseEndpoint:"",defaultMiddlewares:[],namedMiddlewares:{},defaultHeaders:{}},ne=({baseEndpoint:e,middlewares:t=[],headers:n={}})=>{if(Array.isArray(t))t.forEach((e=>{if("function"!=typeof e)throw new Error("Each middleware in defaultMiddlewares must be a function.")}));else{if("function"!=typeof t)throw new Error("Invalid middlewares. It should be a function or an array of functions.");t=[t]}if(te.baseEndpoint=e,te.defaultMiddlewares=t,"object"!=typeof n)throw new Error("Invalid headers format. It should be an object.");te.defaultHeaders={...n}},re=(e,t)=>{if("string"!=typeof e||"function"!=typeof t)throw new Error("Middleware name must be a string and middleware must be a function.");te.namedMiddlewares[e]=t},oe=async(e,t)=>{const n=[...te.defaultMiddlewares,...ae(t)],r=await Promise.all(n.map((async t=>{try{return!1!==await t(e)}catch(e){return console.error("Middleware error:",e),!1}})));return r},ae=e=>"string"==typeof e?te.namedMiddlewares[e]?[te.namedMiddlewares[e]]:[]:Array.isArray(e)?e.map((e=>te.namedMiddlewares[e])).filter(Boolean):[],ie=async(e,t={},n=[])=>le(e,{method:"GET",...t},n),se=async(e,t,n={},r=[])=>le(e,{method:"POST",body:JSON.stringify(t),...n},r),ce=async(e,t,n={},r=[])=>le(e,{method:"PUT",body:JSON.stringify(t),...n},r),ue=async(e,t={},n=[])=>le(e,{method:"DELETE",...t},n),le=async(e,t={},n=[])=>{if(t.headers=t.headers||{},t.query=t.query||{},!(await oe(t,n)).every((e=>e)))throw new Error("Middleware failed, API request blocked");const r=new URL(`${te.baseEndpoint}${e}`),o=t.query||{};Object.keys(o).forEach((e=>r.searchParams.set(e,o[e])));const a=r.toString(),i={"Content-Type":"application/json",Accept:"application/json",...te.defaultHeaders,...t.headers};"GET"==t.method&&delete i["Content-Type"];const s={...t,headers:i};try{const e=await fetch(a,s);if(!e.ok)throw new Error(`Request failed with status ${e.status}`);return await e.json()}catch(e){throw console.error("API request failed:",e),e}};var fe=Object.prototype.toString,de=Array.isArray||function(e){return"[object Array]"===fe.call(e)};function pe(e){return"function"==typeof e}function he(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function ge(e,t){return null!=e&&"object"==typeof e&&t in e}var ye=RegExp.prototype.test,we=/\S/;var me={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},ve=/\s*/,be=/\s+/,Ee=/\s*=/,Se=/\s*\}/,ke=/#|\^|\/|>|\{|&|=|!/;function Pe(e){this.string=e,this.tail=e,this.pos=0}function Te(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function Le(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Pe.prototype.eos=function(){return""===this.tail},Pe.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Pe.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},Te.prototype.push=function(e){return new Te(e,this)},Te.prototype.lookup=function(e){var t,n,r,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var a,i,s,c=this,u=!1;c;){if(e.indexOf(".")>0)for(a=c.view,i=e.split("."),s=0;null!=a&&s<i.length;)s===i.length-1&&(u=ge(a,i[s])||(n=a,r=i[s],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),a=a[i[s++]];else a=c.view[e],u=ge(c.view,e);if(u){t=a;break}c=c.parent}o[e]=t}return pe(t)&&(t=t.call(this.view)),t},Le.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},Le.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||xe.tags).join(":"),o=void 0!==n,a=o?n.get(r):void 0;return null==a&&(a=function(e,t){if(!e)return[];var n,r,o,a,i=!1,s=[],c=[],u=[],l=!1,f=!1,d="",p=0;function h(){if(l&&!f)for(;u.length;)delete c[u.pop()];else u=[];l=!1,f=!1}function g(e){if("string"==typeof e&&(e=e.split(be,2)),!de(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(he(e[0])+"\\s*"),r=new RegExp("\\s*"+he(e[1])),o=new RegExp("\\s*"+he("}"+e[1]))}g(t||xe.tags);for(var y,w,m,v,b,E,S=new Pe(e);!S.eos();){if(y=S.pos,m=S.scanUntil(n))for(var k=0,P=m.length;k<P;++k)a=v=m.charAt(k),function(e,t){return ye.call(e,t)}(we,a)?(f=!0,i=!0,d+=" "):(u.push(c.length),d+=v),c.push(["text",v,y,y+1]),y+=1,"\n"===v&&(h(),d="",p=0,i=!1);if(!S.scan(n))break;if(l=!0,w=S.scan(ke)||"name",S.scan(ve),"="===w?(m=S.scanUntil(Ee),S.scan(Ee),S.scanUntil(r)):"{"===w?(m=S.scanUntil(o),S.scan(Se),S.scanUntil(r),w="&"):m=S.scanUntil(r),!S.scan(r))throw new Error("Unclosed tag at "+S.pos);if(b=">"==w?[w,m,y,S.pos,d,p,i]:[w,m,y,S.pos],p++,c.push(b),"#"===w||"^"===w)s.push(b);else if("/"===w){if(!(E=s.pop()))throw new Error('Unopened section "'+m+'" at '+y);if(E[1]!==m)throw new Error('Unclosed section "'+E[1]+'" at '+y)}else"name"===w||"{"===w||"&"===w?f=!0:"="===w&&g(m)}if(h(),E=s.pop())throw new Error('Unclosed section "'+E[1]+'" at '+S.pos);return function(e){for(var t,n=[],r=n,o=[],a=0,i=e.length;a<i;++a)switch((t=e[a])[0]){case"#":case"^":r.push(t),o.push(t),r=t[4]=[];break;case"/":o.pop()[5]=t[2],r=o.length>0?o[o.length-1][4]:n;break;default:r.push(t)}return n}(function(e){for(var t,n,r=[],o=0,a=e.length;o<a;++o)(t=e[o])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(c))}(e,t),o&&n.set(r,a)),a},Le.prototype.render=function(e,t,n,r){var o=this.getConfigTags(r),a=this.parse(e,o),i=t instanceof Te?t:new Te(t,void 0);return this.renderTokens(a,i,n,e,r)},Le.prototype.renderTokens=function(e,t,n,r,o){for(var a,i,s,c="",u=0,l=e.length;u<l;++u)s=void 0,"#"===(i=(a=e[u])[0])?s=this.renderSection(a,t,n,r,o):"^"===i?s=this.renderInverted(a,t,n,r,o):">"===i?s=this.renderPartial(a,t,n,o):"&"===i?s=this.unescapedValue(a,t):"name"===i?s=this.escapedValue(a,t,o):"text"===i&&(s=this.rawValue(a)),void 0!==s&&(c+=s);return c},Le.prototype.renderSection=function(e,t,n,r,o){var a=this,i="",s=t.lookup(e[1]);if(s){if(de(s))for(var c=0,u=s.length;c<u;++c)i+=this.renderTokens(e[4],t.push(s[c]),n,r,o);else if("object"==typeof s||"string"==typeof s||"number"==typeof s)i+=this.renderTokens(e[4],t.push(s),n,r,o);else if(pe(s)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(s=s.call(t.view,r.slice(e[3],e[5]),(function(e){return a.render(e,t,n,o)})))&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,o);return i}},Le.prototype.renderInverted=function(e,t,n,r,o){var a=t.lookup(e[1]);if(!a||de(a)&&0===a.length)return this.renderTokens(e[4],t,n,r,o)},Le.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),o=e.split("\n"),a=0;a<o.length;a++)o[a].length&&(a>0||!n)&&(o[a]=r+o[a]);return o.join("\n")},Le.prototype.renderPartial=function(e,t,n,r){if(n){var o=this.getConfigTags(r),a=pe(n)?n(e[1]):n[e[1]];if(null!=a){var i=e[6],s=e[5],c=e[4],u=a;0==s&&c&&(u=this.indentPartial(a,c,i));var l=this.parse(u,o);return this.renderTokens(l,t,n,u,r)}}},Le.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},Le.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||xe.escape,o=t.lookup(e[1]);if(null!=o)return"number"==typeof o&&r===xe.escape?String(o):r(o)},Le.prototype.rawValue=function(e){return e[1]},Le.prototype.getConfigTags=function(e){return de(e)?e:e&&"object"==typeof e?e.tags:void 0},Le.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!de(e)?e.escape:void 0};var xe={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){Ae.templateCache=e},get templateCache(){return Ae.templateCache}},Ae=new Le;xe.clearCache=function(){return Ae.clearCache()},xe.parse=function(e,t){return Ae.parse(e,t)},xe.render=function(e,t,n,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(de(o=e)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return Ae.render(e,t,n,r)},xe.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return me[e]}))},xe.Scanner=Pe,xe.Context=Te,xe.Writer=Le;const Ce=xe,je={currentLang:null,translations:{},prefix:`${window.location.origin}/translations`};function $e(e){je.prefix=e}async function Ie(e,t=null){if(!je.translations[e]){je.translations[e]=N.FETCHING;try{const t=await fetch(`${je.prefix}/${e}.json`);if(!t.ok)throw new Error(`Language file ${e} not found`);const n=await t.json();je.translations[e]=n,je.currentLang=e}catch(t){je.translations[e]=N.NULL,console.error(t)}return"function"==typeof t?t():void 0}"function"==typeof t&&t()}function Me(e,t={}){const n=e.split(".");let r=je.translations[je.currentLang];for(let t of n){if(!r||!r[t])return`_${e}_`;r=r[t]}return Oe(r,t)}function Oe(e,t){return e.replace(/\{([a-zA-Z0-9_.]+)\}/g,((e,n)=>{const r=n.split(".");let o=t;for(let t of r){if(!o||void 0===o[t])return e;o=o[t]}return void 0!==o?o:e}))}async function Ne(e,t={}){if(!je.currentLang)return console.warn("No language set!, Please set a language using Translator.init(lang) before calling translate()"),e;const n=je.translations[je.currentLang]===N.FETCHING,r=!je.translations[je.currentLang],o=()=>e.replace(/_([^_]+)_/g,((e,n)=>Me(n,t)||e));if(r||n)try{return console.warn("isMissing | isFetching",n,r),await Ie(je.currentLang,o)}catch(t){return console.error(`Translation loading failed for language: ${je.currentLang}`,t),e}else console.log("Alread Loaded",je.currentLang);return o()}async function Ue(e){e&&await Ie(e)}const De=je;function Re(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}const qe={prefix:`${window.location.origin}/templates`,caches:new Map,extension:".html",container:document.body,metric:null,engine:Ce,config:{}};function Fe(e){qe.prefix=e}const _e=qe.engine;async function He(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch template from ${e}`);return await t.text()}catch(e){return console.error("Error fetching template:",e),""}}async function Ge(e){for(let t of e)if(qe.caches.has(t))console.log(`Template ${t} is Already Loaded`);else{const e=`${qe.prefix}${t}${qe.extension}`;try{qe.caches.set(t,N.FETCHING);const n=await He(e);n&&qe.caches.set(t,n)}catch(e){qe.caches.delete(t),console.error(`Failed to preload template at path ${t}:`,e)}}}function Qe(e,t){qe.caches.set(e,t)}function Je(e){qe.caches.delete(e)}async function Ve(e){const t=`${qe.prefix}${e}${qe.extension}`;try{const n=await He(t);n&&Qe(e,n)}catch(t){console.error(`Error refreshing template at ${e}:`,t)}}async function We(e,t,n={},r){if(!Re(t=t||{}))throw new Error("data must be an object");await Ge([e]);const o=qe.caches.get(e);if(!o)throw new Error(`Template for path "${e}" not found.`);const a=Re(qe.config.defaults)?qe.config.defaults:{};t={...t,...a};const i=o;return Ne(await Be(i,t,n,r),t)}async function ze(e,t,n={},r){try{qe.container.classList.add("loading"),n=Re(n)?n:{};const o={},a=[];for(const[e,t]of Object.entries(n))"string"==typeof t?o[e]=t:Re(t)&&t.path&&a.push(Ge([t.path]).then((()=>{const n=qe.caches.get(t.path);if(!n)throw new Error(`Partial template for "${t.path}" not found.`);o[e]=n})));await Promise.all(a);const i=await We(e,t,o,r);qe.container.innerHTML=i,qe.container.classList.remove("loading"),qe.container.classList.add(`template${e.replaceAll("/","-")}`)}catch(t){console.error(`Failed to render template for path "${e}":`,t)}}async function Be(e,t,n={},r){return qe.engine.render(e,t,n,r)}const Ke={add:Qe,delete:Je,refresh:Ve};function Ze(e={}){"object"==typeof e&&(qe.config=e)}const Xe=e=>qe.container=e,Ye={id:null};async function et(){const e=await E.get("deviceId");e?Ye.id=e:(Ye.id=await tt(),await E.set("deviceId",Ye.id))}async function tt(){return await ut(`${Date.now()}-${Math.random().toString(36).substr(2,9)}`)}function nt(){return Ye.id}function rt(){return{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language}}function ot(){return{touchSupport:"ontouchstart"in window||navigator.maxTouchPoints>0,screenResolution:{width:window.screen.width,height:window.screen.height}}}function at(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(e){const{effectiveType:t,downlink:n,rtt:r}=e;return{effectiveType:t,downlink:n,rtt:r}}return{effectiveType:"unknown",downlink:"unknown",rtt:"unknown"}}async function it(e){if(!navigator.permissions)return"unsupported";try{return(await navigator.permissions.query({name:e})).state}catch(e){return console.error("Permission query error:",e),"error"}}async function st(){if(navigator.storage&&navigator.storage.estimate)try{const{quota:e,usage:t}=await navigator.storage.estimate();return{quota:e,usage:t}}catch(e){return console.error("Storage estimation error:",e),{quota:null,usage:null}}return{quota:null,usage:null}}async function ct(){return ut([navigator.userAgent,navigator.language||navigator.languages.join(","),navigator.platform,navigator.hardwareConcurrency||"N/A",navigator.deviceMemory||"N/A",screen.colorDepth,screen.width,screen.height,screen.pixelDepth,navigator.maxTouchPoints||0].filter(Boolean).join("|"))}async function ut(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}function lt(){const e=navigator.userAgent,t=/Mobi|Android/i.test(e),n=/Tablet|iPad/i.test(e);return{isMobile:t,isTablet:n,isIOS:/iPhone|iPad|iPod/i.test(e),isAndroid:/Android/i.test(e),isWindows:/Windows/i.test(e),isMac:/Mac/i.test(e),isLinux:/Linux/i.test(e),isDesktop:!t&&!n}}const ft=new WeakMap,dt={};function pt(e){if(dt.container="string"==typeof e?document.querySelector(e):e,!(dt.container instanceof HTMLElement))throw new Error("Invalid container specified for event delegation.")}function ht(e,t,n){if(!dt.container)throw new Error("Event system is not initialized. Call `init(container)` first.");const r=t=>{const r=t.target.closest(e);r&&dt.container.contains(r)&&n(t,r)};dt.container.addEventListener(t,r),ft.has(dt.container)||ft.set(dt.container,{});const o=ft.get(dt.container);o[t]||(o[t]=[]),o[t].includes(r)||o[t].push(r)}function gt(e,t){if(!dt.container)throw new Error("Event system is not initialized. Call `init(container)` first.");const n=ft.get(dt.container);if(n&&n[e]){if(t){const r=n[e].indexOf(t);-1!==r&&(dt.container.removeEventListener(e,t),n[e].splice(r,1))}else n[e].forEach((t=>{dt.container.removeEventListener(e,t)})),delete n[e];0===Object.keys(n).length&&ft.delete(dt.container)}}const yt={},wt="https://get.geojs.io/v1",mt={GRANTED:"granted",DENIED:"denied",PROMPT:"prompt"};async function vt(){try{const{latitude:e,longitude:t}=await(await St()?kt():async function(){try{const e=await fetch(`${wt}/ip/geo.json`);if(!e.ok)throw new Error("Failed to fetch IP-based geolocation data");return await e.json()}catch(e){return console.error("Error fetching IP-based location:",e),{latitude:null,longitude:null}}}());return console.log("Location:",e,t),yt.location={latitude:+e,longitude:+t},yt.location}catch(e){console.error("Error during initialization:",e)}}async function bt(){return yt.location?yt.location:await vt()}async function Et(){try{const{state:e}=await navigator.permissions.query({name:"geolocation"});return e}catch(e){return console.error("Error retrieving geolocation permission state:",e),"unknown"}}async function St(){return await Et()===mt.GRANTED}async function kt(){return new Promise(((e,t)=>{navigator.geolocation.getCurrentPosition((t=>{e({latitude:t.coords.latitude,longitude:t.coords.longitude})}),(e=>{console.error("Geolocation error:",e),t({latitude:null,longitude:null})}))}))}async function Pt(){return new Promise((e=>{if(!navigator.geolocation)return console.error("Geolocation is not supported by this browser."),void e(!1);navigator.geolocation.getCurrentPosition((()=>e(!0)),(t=>{console.error("Error prompting for geolocation permission:",t),e(!1)}))}))}const Tt={};!async function(){R(),await et()}(),(e=>{if(document.body)e();else{const t=new MutationObserver((()=>{document.body&&(t.disconnect(),e())}));t.observe(document.documentElement,{childList:!0})}})((()=>{Tt.container=(()=>{const e=document.createElement("div");return e.id="flxy",document.body.prepend(e),e})(),Xe(Tt.container),pt(Tt.container)}));const Lt={template:s,translator:i,router:o,api:a,emitter:n,device:c,states:r,events:u,location:l};Object.keys(Lt).forEach((e=>Tt[e]={...Lt[e]}));const xt=Tt;return t.default})()));